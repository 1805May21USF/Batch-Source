-- Section 2.1
SELECT * FROM EMPLOYEE;

SELECT * FROM EMPLOYEE WHERE LASTNAME = 'King';

SELECT * FROM EMPLOYEE WHERE FIRSTNAME = 'Andrew' AND REPORTSTO IS NULL;

-- Section 2.2

SELECT * FROM ALBUM
ORDER BY TITLE;

SELECT FIRSTNAME FROM CUSTOMER
ORDER BY CITY DESC;

-- Section 2.3

INSERT INTO GENRE (GENREID,NAME) VALUES (26,'EDC');
INSERT INTO GENRE (GENREID,NAME) VALUES (27,'BASSY');

INSERT INTO EMPLOYEE (EMPLOYEEID,LASTNAME,FIRSTNAME,TITLE,REPORTSTO,BIRTHDATE,
HIREDATE,ADDRESS,CITY,STATE,COUNTRY,POSTALCODE,PHONE, FAX, EMAIL) VALUES 
(9,'Smith','Bob','Janitor',7,SYSDATE,SYSDATE,'123 Wallaby Way','Edmonton','AB','Canada','T5K 2N1',
'+1 (555) 442-535','+1 (555) 442-535','bobsmith@gmail.com');

INSERT INTO EMPLOYEE (EMPLOYEEID,LASTNAME,FIRSTNAME,TITLE,REPORTSTO,BIRTHDATE,
HIREDATE,ADDRESS,CITY,STATE,COUNTRY,POSTALCODE,PHONE, FAX, EMAIL) VALUES 
(9,'Jackson','Smith','Fluffer',7,SYSDATE,SYSDATE,'132 Wallaby Way','Edmonton','AB','Canada','T5K 2N1',
'+1 (555) 442-535','+1 (555) 442-535','jacksonsmith@gmail.com');

INSERT INTO CUSTOMER (CUSTOMERID,LASTNAME,FIRSTNAME,EMAIL) VALUES (60,'Doggy','Do','doggydo@gmail.com');
INSERT INTO CUSTOMER (CUSTOMERID,LASTNAME,FIRSTNAME,EMAIL) VALUES (61,'Dog','Doggy','dogdoggy@gmail.com');

-- Section 2.4

UPDATE CUSTOMER SET FIRSTNAME = 'Robert', LASTNAME = 'Walker' WHERE FIRSTNAME = 'Michael' AND LASTNAME ='Mitchell';
UPDATE ARTIST SET NAME = 'CCR' WHERE NAME = 'Creedence Clearwater Revival';

-- Section 2.5
SELECT * FROM INVOICE WHERE BILLINGADDRESS LIKE 'T%';

-- Section 2.6
SELECT * FROM INVOICE WHERE TOTAL BETWEEN 15 AND 50;
SELECT * FROM EMPLOYEE WHERE HIREDATE BETWEEN '01-JUN-2003' AND '01-MAR-2004';

-- Section 2.7

DELETE FROM INVOICELINE WHERE INVOICEID IN (SELECT INVOICEID FROM INVOICE WHERE CUSTOMERID =32);
DELETE FROM INVOICE WHERE CUSTOMERID = 32;
DELETE FROM CUSTOMER WHERE FIRSTNAME = 'Robert' AND LASTNAME = 'Walker';

-- Section 3.1

CREATE OR REPLACE FUNCTION getcurrentdate
    RETURN DATE
    IS
    BEGIN
        RETURN SYSTIMESTAMP;
    END getcurrentdate;
    /
    
SELECT getcurrentdate FROM DUAL;

CREATE OR REPLACE FUNCTION getl(str IN STRING)
    RETURN NUMBER
    IS
    BEGIN
        RETURN LENGTH(str);
    END getl;
    
/

SELECT getl(NAME) FROM MEDIATYPE;

--SECTION 3.2
CREATE OR REPLACE FUNCTION average(total IN NUMBER)
    RETURN NUMBER
    IS
    BEGIN
        RETURN AVG(total);
    END average;
    /

SELECT avg(TOTAL) FROM INVOICE; 


create or replace FUNCTION top
    RETURN AGGREGATE USING titles;
    BEGIN
        SELECT NAME AS titles FROM TRACK WHERE UNITPRICE IN (SELECT MAX(UNITPRICE) FROM TRACK);
        RETURN titles;
    END top;
/

SELECT top FROM DUAL;

